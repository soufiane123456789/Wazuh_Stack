<group name="sshd_custom">

  <!-- Failed SSH login -->
  <rule id="4795" level="5">
    <match>Failed password for</match>
    <description>Custom SSH failed login attempt detected</description>
    <group>sshd_custom, ssh, authentication_failed</group>
  </rule>

  <!-- Successful SSH login -->
  <rule id="5715" level="3">
    <match>Accepted password for</match>
    <description>Custom SSH successful login detected</description>
    <group>sshd_custom, ssh, authentication_success</group>
  </rule>

  <!-- Multiple failed attempts -->
  <rule id="4956" level="10" frequency="5" timeframe="300">
    <if_matched_sid>4795</if_matched_sid>
    <same_source_ip/>
    <same_user/>
    <description>Multiple SSH failed attempts detected (staging)</description>
    <group>ssh_failed_staging</group>
  </rule>

  <!-- Suspicious SSH login pattern -->
  <rule id="4957" level="15">
    <match>Accepted password for</match>
    <description>Suspicious SSH login pattern: multiple failed attempts followed by a successful login</description>
    <group>ssh_suspicious, ssh, correlation</group>
    <mitre>
      <id>T1110</id>
      <id>T1078</id>
    </mitre>
  </rule>

</group>

